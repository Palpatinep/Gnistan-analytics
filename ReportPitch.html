<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report Pitch</title>
</head>
<!-- <link rel="stylesheet" href="https://code.jquery.com/ui/1.14.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
  <script src="https://code.jquery.com/ui/1.14.1/jquery-ui.js"></script>
  <script
  src="https://code.jquery.com/jquery-3.7.1.js"
  integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
  crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> -->
<style>
    body{
        font-family: Verdana, Geneva, Tahoma, sans-serif
    }
    #leftdiv{
        float: left;
        /* background: Red; */
        width: 35%;
        height: 1000px;
    }
    #middlediv {
        float: left;
        /* background: Green; */
        width: 40%;
        height: 1000px;
    }

    #rightdiv {
        float: right;
        /* background: blue; */
        width: 25%;
        height: 1000px;
    }
    button{
        width: 100px;
        height: 100px;
        font-family: Verdana, Geneva, Tahoma, sans-serif
    }
    button.inactivebutton
    {
        background-color: red;
    }
    button.activebutton
    {
        background-color: green;
    }
    ul {
        list-style: none;
        width: 300px;
    }
    li {
        /* background-color: red; */
        margin-top: 0px;
        padding: 4px;
        cursor: pointer;
        border-radius: 5px;
        font-size: 12px;
    }
    tr {
        padding-bottom: 30px;
        font-size: 16px;
    }
    td {
        padding-bottom: 10px;
    }
    .range_container {
  display: flex;
  flex-direction: column;
  width: 90%;
  margin: 2% auto;
}

.sliders_control {
  position: relative;
  min-height: 30px;
}

.form_control {
  position: relative;
  display: flex;
  justify-content: space-between;
  font-size: 24px;
  color: #635a5a;
}

input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  pointer-events: all;
  width: 24px;
  height: 24px;
  background-color: #fff;
  border-radius: 50%;
  box-shadow: 0 0 0 1px #C6C6C6;
  cursor: pointer;
}

input[type=range]::-moz-range-thumb {
  /* -webkit-appearance: none; */
  pointer-events: all;
  width: 24px;
  height: 24px;
  background-color: #fff;
  border-radius: 50%;
  box-shadow: 0 0 0 1px #C6C6C6;
  cursor: pointer;
}

input[type=range]::-webkit-slider-thumb:hover {
  background: #f7f7f7;
}

input[type=range]::-webkit-slider-thumb:active {
  box-shadow: inset 0 0 3px #387bbe, 0 0 9px #387bbe;
  -webkit-box-shadow: inset 0 0 3px #387bbe, 0 0 9px #387bbe;
}

input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  height: 10px;
  width: 100%;
  position: absolute;
  background-color: #f79847;
  pointer-events: none;
}

#fromSlider {
  height: 0;
  z-index: 1;
  top: 5px;
}

option{
    font-family: Verdana, Geneva, Tahoma, sans-serif;
    font-size: 15px;
}

select{
    font-family: Verdana, Geneva, Tahoma, sans-serif;
    font-size: 12px;
    padding-left: 10px;
    padding-right: 10px;
}

img:hover{
    cursor: pointer;
}
</style>
<body>
    <div style="display: flex;">
    <img onclick="location.href='index.html'" style="width: 30px; height: 30px; margin-left: 10px;" src="back-arrow-icon.png">
        <form>
            <label for="matches" style="margin-left: 30px;">Choose a match:</label>
            <select name="matches" id="matches" style="margin-left: 20px;" onchange="matchChange()">
              <option value="1">Gnistan p10 vs TPS, 11.1.2025</option>
              <option value="2">Gnistan p10 vs KÃ¤pa, 19.1.2025</option>
            </select>
        </form>
    </div>
    
    <br>

    <div id="leftdiv">
        <canvas id="pitchcanvas" width="600" height="850"></canvas>
    </div>
    <div id="middlediv">

        <div class="range_container" style="margin-bottom: 0px;">
            <div class="sliders_control">
              <input id="fromSlider" type="range" value="0" min="0" max="90" />
              <input id="toSlider" type="range" value="90" min="0" max="90" />
            </div>
        </div>

        <div style="margin-top: 0px;">
            <span id="fromminutetext" style="margin-left: 6%; width: 50px;">0</span>
            <span id="tominutetext" style="margin-right: 1%; width: 50px; float: right;">90</span>
        </div>

        <div style="margin-left: 10%; margin-top: 40px; display: inline-block">
            <!-- <div>
                <button onclick="boxentryclick()">Box entry</button>
            </div>
            <div style="margin-left: 10px;">
                <button onclick="pressclick()">Press</button>
            </div>
            <div style="margin-left: 10px;">
                <button onclick="xgclick()">xG</button>
            </div>
            <div style="margin-left: 10px;">
                <button onclick="videoclick()">Video</button>
            </div> -->
            <img id="footballpitch" width="1" height="1" src="pitchpng.png">
            <img id="presspitch" width="1" height="1" src="presspitchpng.png">
            
        </div>

        <div style="width: 100%; display: inline-flex">
            <a1 id="hometeamtext" style="margin-top: 100px; margin-left: 45px; width: 20%; font-size: 20px;">Home</a1>
            <a1 id="matchinfotext" style="margin-top: 100px; text-align: center; width: 60%; font-size: 12px;">Home</a1>
            <a1 id="awayteamtext" style="margin-top: 100px; margin-right: 45px; width: 20%; float: right; text-align: right; font-size: 20px;">Away</a1>
        </div>
    
        <br>
        <div id="reportvideodiv" style="position: relative;">
            <div id="reportdiv" style="position: absolute; margin-top: 20px; border-color: gray; border-width: 2px; border-radius: 5px; border-style: solid; height: 300px; width: 100%">
                <table style="width: 100%; text-align: center;">
                    <tr>
                      <td id="homegoaltext">0</td>
                      <td>Goals</td>
                      <td id="awaygoaltext">0</td>
                    </tr>
                    <tr>
                        <td id="homexgtext">0</td>
                        <td id="xgtext" style="cursor: pointer; border-radius: 5px;" onclick="xgclick()">xG</td>
                        <td id="awayxgtext">0</td>
                    </tr>
                    <tr>
                      <td id="homeaccshottext">0</td>
                      <td id="accshottext" style="cursor: pointer; border-radius: 5px;" onclick="accshotclick()">Accelerations shot/cross/SP</td>
                      <td id="awayaccshottext">0</td>
                    </tr>
                    <tr>
                        <td id="homeaccturnovertext">0</td>
                        <td id="accturnovertext" style="cursor: pointer; border-radius: 5px;" onclick="accturnoverclick()">Accelerations turnover</td>
                        <td id="awayaccturnovertext">0</td>
                    </tr>
                    <tr>
                        <td id="homeaccslowtext">0</td>
                        <td id="accslowtext" style="cursor: pointer; border-radius: 5px;" onclick="accslowclick()">Accelerations too slow (no restart)</td>
                        <td id="awayaccslowtext">0</td>
                    </tr>
                    <tr>
                        <td id="homeaccrestarttext">0</td>
                        <td id="accrestarttext" style="cursor: pointer; border-radius: 5px;" onclick="accrestartclick()">Accelerations with restart</td>
                        <td id="awayaccrestarttext">0</td>
                    </tr>
                    <tr>
                        <td id="homeboxentrytext">0</td>
                        <td id="boxentrytext" style="cursor: pointer; border-radius: 5px;" onclick="boxentryclick()">Box entries</td>
                        <td id="awayboxentrytext">0</td>
                    </tr>
                    <tr>
                        <td id="homepresstext">0</td>
                        <td id="presstext" style="cursor: pointer; border-radius: 5px;" onclick="pressclick()">Defensive actions</td>
                        <td id="awaypresstext">0</td>
                    </tr>
                    
                    <tr>
                    <td id="homepostext">0 %</td>
                    <td>Ball Possession</td>
                    <td id="awaypostext">0 %</td>
                    </tr>
                  </table>
            </div>
            <div id="boxentryspecdiv" style="visibility: hidden; position: absolute; background-color: rgb(220, 220, 220); border-color: gray; border-radius: 5px; border-width: 2px; border-style: solid; width: 100%; margin-top: 50px; text-align: center;">
                <table style="width: 100%; text-align: center;">
                    <tr>
                      <td id="homeboxentrytext2">0</td>
                      <td>Box Entries</td>
                      <td id="awayboxentrytext2">0</td>
                    </tr>
                    <tr>
                        <td id="homeboxentrybypasstext">0</td>
                        <td>By Pass/Cross</td>
                        <td id="awayboxentrybypasstext">0</td>
                      </tr>
                    <tr>
                      <td id="homeboxentrybydribbletext">0</td>
                      <td>By Dribble</td>
                      <td id="awayboxentrybydribbletext">0</td>
                    </tr>
                </table>
                <br>
                <br>
                <span onclick="document.getElementById('boxentryspecdiv').style.visibility = 'hidden'" style="cursor: pointer;">Close</span>
            </div>
            <div id="pressspecdiv" style="visibility: hidden; position: absolute; background-color: rgb(220, 220, 220); border-color: gray; border-radius: 5px; border-width: 2px; border-style: solid; width: 100%; margin-top: 50px; text-align: center;">
                <table style="width: 100%; text-align: center;">
                    <tr>
                      <td id="homepresstext2">0</td>
                      <td>Defensive actions</td>
                      <td id="awaypresstext2">0</td>
                    </tr>
                    <tr>
                        <td id="homepresspresszonetext">0</td>
                        <td>Defensive actions - Press Zone</td>
                        <td id="awaypresspresszonetext">0</td>
                    </tr>
                    <tr>
                        <td id="homepressblockzonetext">0</td>
                        <td>Defensive actions - Block Zone</td>
                        <td id="awaypressblockzonetext">0</td>
                    </tr>
                    <tr>
                        <td id="homepresschasezonetext">0</td>
                        <td>Defensive actions - Chase Zone</td>
                        <td id="awaypresschasezonetext">0</td>
                    </tr>
                    <tr>
                        <td id="hometransitionplustext">0</td>
                        <td>Transition +</td>
                        <td id="awaytransitionplustext">0</td>
                    </tr>
                    <tr>
                        <td id="hometransitionpluspresszonetext">0</td>
                        <td>Transition + - Press Zone</td>
                        <td id="awaytransitionpluspresszonetext">0</td>
                    </tr>
                    <tr>
                        <td id="hometransitionplusblockzonetext">0</td>
                        <td>Transition + - Block Zone</td>
                        <td id="awaytransitionplusblockzonetext">0</td>
                    </tr>
                    <tr>
                        <td id="hometransitionpluschasezonetext">0</td>
                        <td>Transition + - Chase Zone</td>
                        <td id="awaytransitionpluschasezonetext">0</td>
                    </tr>
                    <tr>
                      <td id="homefoultext">0</td>
                      <td>Fouls</td>
                      <td id="awayfoultext">0</td>
                    </tr>
                    <tr>
                        <td id="homefoulpresszonetext">0</td>
                        <td>Fouls - Press Zone</td>
                        <td id="awayfoulpresszonetext">0</td>
                    </tr>
                    <tr>
                        <td id="homefoulblockzonetext">0</td>
                        <td>Fouls - Block Zone</td>
                        <td id="awayfoulblockzonetext">0</td>
                    </tr>
                    <tr>
                        <td id="homefoulchasezonetext">0</td>
                        <td>Fouls - Chase Zone</td>
                        <td id="awayfoulchasezonetext">0</td>
                    </tr>
                    <tr>
                        <td id="homeclearancetext">0</td>
                        <td>Clearances/Blocks</td>
                        <td id="awayclearancetext">0</td>
                    </tr>
                    <tr>
                        <td id="homeclearancepresszonetext">0</td>
                        <td>Clearances/Blocks - Press Zone</td>
                        <td id="awayclearancepresszonetext">0</td>
                    </tr>
                    <tr>
                        <td id="homeclearanceblockzonetext">0</td>
                        <td>Clearances/Blocks - Block Zone</td>
                        <td id="awayclearanceblockzonetext">0</td>
                    </tr>
                    <tr>
                        <td id="homeclearancechasezonetext">0</td>
                        <td>Clearances/Blocks - Chase Zone</td>
                        <td id="awayclearancechasezonetext">0</td>
                    </tr>
                </table>
                <br>
                <br>
                <span onclick="document.getElementById('pressspecdiv').style.visibility = 'hidden'" style="cursor: pointer;">Close</span>
            </div>
            <div id="videodiv" style="visibility: hidden; position: absolute; background-color: rgb(211, 211, 211); border-color: gray; border-radius: 5px; border-width: 2px; border-style: solid; text-align: center; width: 100%;">
                <video id="fullmatchvideo" width=98% height="500" controls>
                    <source src="https://seed191.bitchute.com/pupNZR0eMW9M/4CU38o2lkgyj.mp4" type="video/mp4">
                    <source src="movie.ogg" type="video/ogg">
                  Your browser does not support the video tag.
                </video>
                <!-- <iframe id="fullmatchvideo" type="text/html" src="https://drive.google.com/file/d/1jmx64cq1cVT4_Ereaf_0EFAPf1c3xKw8/preview?t=700" width="640" height="480" allow="autoplay" allowfullscreen width=98% height="500"> -->

                </iframe>
                <span onclick="closevideoclick()" style="float: left; margin-left: 10px; font-size: 12px; cursor: pointer; padding-bottom: 20px;">Close video</span>
                <span onclick="showVideoSettings()" style="float: right; margin-right: 10px; font-size: 12px; cursor: pointer; padding-bottom: 20px;">Video Settings</span>
                <div id="videosettingsdiv" style="display: none;">
                    <p>Match Duration: 2 x </p><input style="width: 30px;" placeholder="30" value="30" id="matchdurationinput">
                    <p>First Half Start Time:</p> <input style="width: 30px;" placeholder="0" value="0" id="firsthalfstartinputminutes"><input style="width: 30px;" placeholder="0" value="0" id="firsthalfstartinputseconds">
                    <p>Second Half Start Time:</p> <input style="width: 30px;" placeholder="45" value="45" id="secondhalfstartinputminutes"><input style="width: 30px;" placeholder="0" value="0" id="secondhalfstartinputseconds">
                </div>
            </div>
        </div>        
    </div>
    <div id="rightdiv">
        <div style="display: none;">
            <p id="mousepostext">Mouse pos: X Y</p>
            <p id="mousepos2text">Mouse pos: X Y</p>
            <p id="hitbox">Hitbox</p>
            <p id="selectedtext">Selected Tag:</p>
            <p id="clickedentryindextext">Clicked Entry Index: 999</p>
            <p id="clickedlistindextext">Clicked List Index: 999</p>
            <p id="hoverentryindextext">Hover Entry Index: 999</p>
            <p id="hoverlistindextext">Hover List Index: 999</p>
        </div>
        
        <div style="margin-top: 10px; margin-left: 20px; border-radius: 5px; border-width: 2px; border-color: rgb(163, 163, 163); border-style: solid; min-height: 800px;">
            <br>
            <a1 id="matchactionstext" style="font-size: 20px; margin-left: 40px; margin-top: 50px;">Match actions:</a1>
            <ul id="taglist" style="margin-left: 0px;">
        </div>
        
        </ul>
        
    </div>
</body>
<script
  src="https://code.jquery.com/jquery-3.7.1.js"integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="crossorigin="anonymous">
</script>
<script>
    const canvas = document.getElementById("pitchcanvas");
    const ctx = canvas.getContext("2d");
    const img = document.getElementById("footballpitch")
    const pressimg = document.getElementById("presspitch")
    var mousexperc;
    var mouseyperc;
    var mousex;
    var mousey;
    var pitchpos = document.getElementById("pitchcanvas").getBoundingClientRect();
    var homeposperc = 0;
    var homepossec = 0;
    var awayposperc = 0;
    var awaypossec = 0;
    var ooppossec = 0;
    var entrylist = document.getElementById("taglist");
    var clickedentryindex = 999;
    var clickedlistindex = 999;
    var hoverentryindex = 999;
    var hoverlistindex = 999;
    var actionclicked = false;
    var selectedTag = "";
    var asd = new Path2D();
    var objectList = [];
    var objectListIndex = [];
    var cursorType = "auto"
    var fromSlider = document.getElementById("fromSlider");
    var toSlider = document.getElementById("toSlider");
    var fromMinute = 0;
    var toMinute = 90;
    var fromminuteoutput = document.getElementById("fromminutetext");
    var tominuteoutput = document.getElementById("tominutetext");
    var videoSettingsOnDisplay = false;
    var videoOnDisplay = true;
    var taglog = [];
    var poslog;
    var matchAndVideoSettings;
    var videoSettings;
    var selectedMatchID = 1;
    
    // img.addEventListener("load", (e) => {
    //     ctx.drawImage(img, 0, 0, 600, 850)
    //     // startReport();
    // })

    window.onload = function () {
        console.log("Start")
    
        Promise.all([
                fetch("https://d1w1llg3a01ri8.cloudfront.net/p10_TPS_taglog_110125.txt").then(res => res.json()),
                fetch("https://d1w1llg3a01ri8.cloudfront.net/TPS_matchvideosettings_110125.txt").then(res => res.json())
        ]).then(data => startReport(data[0], [], data[1]))
    }

    // ctx.clearRect(0, 0, canvas.width, canvas.height);

    // function readTaglogFile(file) {
    //     $.get(file, function(data) {
    //         console.log("Test data:")
    //         taglog = JSON.parse(data)
    //         console.log(taglog)
    //         calculateReport(fromMinute, toMinute);
    //     });
    // }

    // function readPosLogFile(file) {
    //     $.get(file, function(data) {
    //         console.log("Poslog data:")
    //         poslog = JSON.parse(data)
    //         console.log(poslog)
    //         calculatePos(fromMinute, toMinute);
    //         // calculateReport(fromMinute, toMinute);
    //     });
    // }

    // function readVideoSettingsFile(file) {
    //     $.get(file, function(data) {
    //         console.log("Video Settings:")
    //         matchAndVideoSettings = JSON.parse(data)
    //         console.log(matchAndVideoSettings)
    //         document.getElementById("firsthalfstartinputminutes").value = matchAndVideoSettings.firstHalfStartTimeMinutes
    //         document.getElementById("firsthalfstartinputseconds").value = matchAndVideoSettings.firstHalfStartTimeSeconds
    //         document.getElementById("secondhalfstartinputminutes").value = matchAndVideoSettings.secondHalfStartTimeMinutes
    //         document.getElementById("secondhalfstartinputseconds").value = matchAndVideoSettings.secondHalfStartTimeSeconds
    //         document.getElementById("matchdurationinput").value = matchAndVideoSettings.matchHalfDuration
    //         document.getElementById("hometeamtext").innerHTML = matchAndVideoSettings.homeTeam
    //         document.getElementById("awayteamtext").innerHTML = matchAndVideoSettings.awayTeam
    //         document.getElementById("matchinfotext").innerHTML = matchAndVideoSettings.dateTime + ", " + matchAndVideoSettings.matchPlace + ", " + "2 x " + matchAndVideoSettings.matchHalfDuration + " min"
    //     });
    // }

    function startReport(tagloginput, posloginput, matchvideosettingsinput)
    {
        taglog = tagloginput;
        poslog = posloginput;
        matchAndVideoSettings = matchvideosettingsinput;
        var videoURL = matchvideosettingsinput.matchvideoURL

        document.getElementById("fullmatchvideo").setAttribute("src", matchvideosettingsinput.matchvideoURL)
        
        console.log("Taglog: ")
        console.log(taglog)
        console.log("Poslog: ")
        console.log(poslog)
        console.log("Match and video settings: ")
        console.log(matchAndVideoSettings)
        

        document.getElementById("firsthalfstartinputminutes").value = matchAndVideoSettings.firstHalfStartTimeMinutes
        document.getElementById("firsthalfstartinputseconds").value = matchAndVideoSettings.firstHalfStartTimeSeconds
        document.getElementById("secondhalfstartinputminutes").value = matchAndVideoSettings.secondHalfStartTimeMinutes
        document.getElementById("secondhalfstartinputseconds").value = matchAndVideoSettings.secondHalfStartTimeSeconds
        document.getElementById("matchdurationinput").value = matchAndVideoSettings.matchHalfDuration
        document.getElementById("hometeamtext").innerHTML = matchAndVideoSettings.homeTeam
        document.getElementById("awayteamtext").innerHTML = matchAndVideoSettings.awayTeam
        document.getElementById("matchinfotext").innerHTML = matchAndVideoSettings.dateTime + ", " + matchAndVideoSettings.matchPlace + ", " + "2 x " + matchAndVideoSettings.matchHalfDuration + " min"
        calculateReport(fromMinute, toMinute);
        calculatePos(fromMinute, toMinute);
        document.getElementById("fullmatchvideo").setAttribute("src", matchvideosettingsinput.matchvideoURL)
        ctx.drawImage(img, 0, 0, 600, 850)
    }

    // readTaglogFile("TPS_taglog.txt");
    // readVideoSettingsFile("MatchandVideoSettings.txt")
    // readPosLogFile("poslog.txt")


    fromSlider.oninput = function() {
        fromMinute = parseInt(this.value)
        fromminuteoutput.innerHTML = fromMinute;

        clickedentryindex = 999;
        drawActionlist(selectedTag)
        drawPitch(selectedTag, clickedentryindex, hoverentryindex, fromMinute, toMinute)
        calculateReport(fromMinute, toMinute)
        calculatePos(fromMinute, toMinute)
    }

    toSlider.oninput = function() {
        toMinute = parseInt(this.value)
        tominuteoutput.innerHTML = toMinute;

        clickedentryindex = 999;
        drawActionlist(selectedTag)
        drawPitch(selectedTag, clickedentryindex, hoverentryindex, fromMinute, toMinute)
        calculateReport(fromMinute, toMinute)
        calculatePos(fromMinute, toMinute)
    }

    function closevideoclick()
    {
        if(videoOnDisplay == true)
        {
            console.log("Video closed")
            document.getElementById("videodiv").style.visibility = "hidden"
            document.getElementById("fullmatchvideo").pause();
            // var iframe = document.getElementById('fullmatchvideo');
            // var iframeSrc = iframe.src;
            // iframe.src = iframeSrc;
            videoOnDisplay = false
        }
        else
        {
            document.getElementById("videodiv").style.visibility = "visible"
            videoOnDisplay = true
        }
    }

    function showVideoSettings()
    {
        if (videoSettingsOnDisplay == false)
        {
            document.getElementById("videosettingsdiv").style.display = "block";
            videoSettingsOnDisplay = true;
        }
        else
        {
            document.getElementById("videosettingsdiv").style.display = "none";
            videoSettingsOnDisplay = false;
        }
    }

    function printMousePos() 
    {
        mousexperc = parseFloat((event.clientX - pitchpos.left) / pitchpos.width).toFixed(4)
        mouseyperc = parseFloat((event.clientY - pitchpos.top)  / pitchpos.height).toFixed(4)
        mousex = mousexperc*pitchpos.width;
        mousey = mouseyperc*pitchpos.height;
        // document.getElementById("mousepostext").innerHTML = "clientX: " + mousexperc + " - clientY: " + mouseyperc;
        // document.getElementById("mousepos2text").innerHTML = "clientX: " + mousex + " - clientY: " + mousey;

        return {mousex, mousey};
    }

    entrylist.addEventListener("click", function (e) {
        actionclicked = true;
        var target = e.target;
        var parent = target.parentNode;
        clickedentryindex = parseInt(target.innerHTML.split(",", 1)[0]);
        clickedlistindex = [].indexOf.call(parent.children, target);
        drawPitch(selectedTag, clickedentryindex, taglog[hoverentryindex], fromMinute, toMinute);
        document.getElementById("clickedentryindextext").innerHTML = "Clicked Entry Index : " + clickedentryindex
        document.getElementById("clickedlistindextext").innerHTML = "Clicked List Index : " + clickedlistindex
        var actionlist = document.querySelectorAll("#taglist")
        actionlist[0].childNodes.forEach(element => {
            if (element != clickedlistindex)
            {
                element.style.backgroundColor = "white";
            }
        });
        actionlist[0].childNodes[clickedlistindex].style.backgroundColor = "rgb(4, 224, 82)";
        
        console.log("CLICK")

        if (taglog[clickedentryindex].firsthalf == true)
        {
            var clipTime = parseInt(taglog[clickedentryindex].timeminute * 60) + parseInt(taglog[clickedentryindex].timesecond) + parseInt(document.getElementById("firsthalfstartinputminutes").value) * 60 + parseInt(document.getElementById("firsthalfstartinputseconds").value) - 3
            console.log("Time test: " + clipTime)
            console.log("Time test2: " + parseInt(taglog[clickedentryindex].timeminute * 60))
        }
        else
        {
            console.log("WHAT")
            var clipTime = parseInt(taglog[clickedentryindex].timeminute * 60) + parseInt(taglog[clickedentryindex].timesecond) + parseInt(document.getElementById("secondhalfstartinputminutes").value) * 60 + parseInt(document.getElementById("secondhalfstartinputseconds").value) - parseInt(document.getElementById("matchdurationinput").value) * 60 - 3     
        }

        if (selectedMatchID == 1)
        {
            clipTime = parseInt(taglog[clickedentryindex].timeminute * 60) + parseInt(taglog[clickedentryindex].timesecond) - 3;
        }

        document.getElementById("videodiv").style.visibility = "visible"
        videoOnDisplay = true;
        document.getElementById("fullmatchvideo").currentTime = clipTime;
        document.getElementById("fullmatchvideo").play();
        // var iframe = document.getElementById('fullmatchvideo');
        // var iframeSrc = iframe.src;
        // var test = iframeSrc.split("?")
        
        // var newtime = test[0] + "?&t=" + clipTime
        // iframe.src = newtime
    })

    entrylist.addEventListener("mouseover", function (e) {
        var target = e.target;
        var parent = target.parentNode;
        hoverentryindex = parseInt(target.innerHTML.split(",", 1)[0]);
        hoverlistindex = [].indexOf.call(parent.children, target);
        document.getElementById("hoverentryindextext").innerHTML = "Hover Entry Index : " + hoverentryindex
        document.getElementById("hoverlistindextext").innerHTML = "Hover List Index : " + hoverlistindex
        drawPitch(selectedTag, clickedentryindex, taglog[hoverentryindex], fromMinute, toMinute);
        var actionlist = document.querySelectorAll("#taglist")
        actionlist[0].childNodes.forEach(element => {
            if (element != hoverlistindex)
            {
                if (clickedentryindex != element.innerHTML.split(",", 1)[0])
                {
                    element.style.backgroundColor = "white";
                }
            }
        });
        actionlist[0].childNodes[hoverlistindex].style.backgroundColor = "rgb(4, 224, 82)";
    })

    canvas.addEventListener("mousemove", (event) => {

        printMousePos();
        document.getElementById("selectedtext").innerHTML = selectedTag;
        var cursorIdentifier = 0;

        for (let i = 0; i < objectList.length; i++)
        {
            if (ctx.isPointInStroke(objectList[i], mousex, mousey))
            {
                cursorIdentifier++;
                document.getElementById("hitbox").innerHTML = "HITHITHITHIT"
                var clickedaction = taglog[objectList[i].index];
                var actionlist = document.querySelectorAll("#taglist")
                hoverentryindex = objectList[i].index
                
                actionlist[0].childNodes.forEach(element => {
                    if (element.innerHTML.split(",", 1)[0] != hoverentryindex)
                    {
                        if (element.innerHTML.split(",", 1)[0] != clickedentryindex)
                        {
                            element.style.backgroundColor = "white";
                        }
                    }
                    else
                    {
                        element.style.backgroundColor = "rgb(4, 224, 82)";
                    }
                });

                drawPitch(selectedTag, clickedentryindex, taglog[hoverentryindex], fromMinute, toMinute);
            }
            else
            {
                document.getElementById("hitbox").innerHTML = "NOT HIT"
            }
        }

        if (cursorIdentifier > 0)
        {
            document.body.style.cursor = 'pointer';
        }
        else
        {
            document.body.style.cursor = 'auto';
        }
        document.getElementById("hoverentryindextext").innerHTML = "Hover Entry Index : " + hoverentryindex
        document.getElementById("hoverlistindextext").innerHTML = "Hover List Index : " + hoverlistindex
    })

    canvas.addEventListener("click", (event) => {

        for (let i = 0; i < objectList.length; i++)
        {
            if (ctx.isPointInStroke(objectList[i], mousex, mousey))
            {

                var hoveredaction = taglog[objectList[i].index];
                clickedentryindex = objectList[i].index;

                document.getElementById("clickedentryindextext").innerHTML = "Clicked Entry Index : " + clickedentryindex
                document.getElementById("clickedlistindextext").innerHTML = "Clicked List Index : " + clickedlistindex
                var actionlist = document.querySelectorAll("#taglist")

                for (let i = 0; i < actionlist[0].childNodes.length; i++)
                {

                    if (parseInt(actionlist[0].childNodes[i].innerHTML.split(",", 1)[0]) != clickedentryindex)
                    {
                        actionlist[0].childNodes[i].style.backgroundColor = "white";
                    }
                    else
                    {
                        clickedlistindex = i;
                        document.getElementById("clickedlistindextext").innerHTML = "Clicked List Index : " + clickedlistindex
                        actionlist[0].childNodes[i].style.backgroundColor = "rgb(1, 143, 51)";
                        
                        if (taglog[clickedentryindex].firsthalf == true)
                        {
                            var clipTime = parseInt(taglog[clickedentryindex].timeminute * 60) + parseInt(taglog[clickedentryindex].timesecond) + parseInt(document.getElementById("firsthalfstartinputminutes").value) * 60 + parseInt(document.getElementById("firsthalfstartinputseconds").value) - 3
                        }
                        else
                        {
                            var clipTime = parseInt(taglog[clickedentryindex].timeminute * 60) + parseInt(taglog[clickedentryindex].timesecond) + parseInt(document.getElementById("secondhalfstartinputminutes").value) * 60 + parseInt(document.getElementById("secondhalfstartinputseconds").value) - parseInt(document.getElementById("matchdurationinput").value) * 60 - 3     
                        }

                        if (selectedMatchID == 1)
                        {
                            var clipTime = parseInt(taglog[clickedentryindex].timeminute * 60) + parseInt(taglog[clickedentryindex].timesecond) - 3;
                        }
                        
                        document.getElementById("videodiv").style.visibility = "visible"
                        videoOnDisplay = true;
                        document.getElementById("fullmatchvideo").currentTime = clipTime;
                        document.getElementById("fullmatchvideo").play();

                        // var iframe = document.getElementById('fullmatchvideo');
                        // var iframeSrc = iframe.src;
                        // var test = iframeSrc.split("?")
                        
                        // var newtime = test[0] + "?&t=" + clipTime
                        // iframe.src = newtime
                    }
                }

                drawPitch(selectedTag, clickedentryindex, hoveredaction, fromMinute, toMinute);
            }
            else
            {
                document.getElementById("hitbox").innerHTML = "NOT HIT"
            }
        }
    })

    function boxentryclick()
    {
        clickedentryindex = 999;
        selectedTag = "boxentry";
        drawActionlist(selectedTag);
        drawPitch(selectedTag, clickedentryindex, hoverentryindex, fromMinute, toMinute);
        document.getElementById('pressspecdiv').style.visibility = "hidden"
        document.getElementById("matchactionstext").innerHTML = "Box entry actions"
        document.getElementById("boxentryspecdiv").style.visibility = "visible"
        document.getElementById("boxentrytext").style.backgroundColor = "rgb(4, 224, 82)";
        document.getElementById("presstext").style.backgroundColor = "white";
        document.getElementById("xgtext").style.backgroundColor = "white";
        document.getElementById("accrestarttext").style.backgroundColor = "white";
        document.getElementById("accshottext").style.backgroundColor = "white";
        document.getElementById("accturnovertext").style.backgroundColor = "white";
        document.getElementById("accslowtext").style.backgroundColor = "white";
    }

    function pressclick()
    {
        clickedentryindex = 999;
        selectedTag = "press";
        drawActionlist(selectedTag);
        drawPitch(selectedTag, clickedentryindex, hoverentryindex, fromMinute, toMinute);
        document.getElementById('boxentryspecdiv').style.visibility = "hidden"
        document.getElementById("matchactionstext").innerHTML = "Defensive actions"
        document.getElementById("pressspecdiv").style.visibility = "visible"
        document.getElementById("presstext").style.backgroundColor = "rgb(4, 224, 82)";
        document.getElementById("boxentrytext").style.backgroundColor = "white";
        document.getElementById("xgtext").style.backgroundColor = "white";
        document.getElementById("accrestarttext").style.backgroundColor = "white";
        document.getElementById("accshottext").style.backgroundColor = "white";
        document.getElementById("accturnovertext").style.backgroundColor = "white";
        document.getElementById("accslowtext").style.backgroundColor = "white";
    }

    function xgclick()
    {
        clickedentryindex = 999;
        selectedTag = "xg";
        drawActionlist(selectedTag);
        drawPitch(selectedTag, clickedentryindex, hoverentryindex, fromMinute, toMinute);
        document.getElementById("matchactionstext").innerHTML = "xG actions"
        document.getElementById("xgtext").style.backgroundColor = "rgb(4, 224, 82)";
        document.getElementById("boxentrytext").style.backgroundColor = "white";
        document.getElementById("presstext").style.backgroundColor = "white";
        document.getElementById("accrestarttext").style.backgroundColor = "white";
        document.getElementById("accshottext").style.backgroundColor = "white";
        document.getElementById("accturnovertext").style.backgroundColor = "white";
        document.getElementById("accslowtext").style.backgroundColor = "white";
    }

    function accshotclick()
    {
        clickedentryindex = 999;
        selectedTag = "accshot";
        drawActionlist(selectedTag);
        drawPitch(selectedTag, clickedentryindex, hoverentryindex, fromMinute, toMinute);
        document.getElementById("matchactionstext").innerHTML = "Accelerations actions"
        document.getElementById("accshottext").style.backgroundColor = "rgb(4, 224, 82)";
        document.getElementById("accturnovertext").style.backgroundColor = "white";
        document.getElementById("accslowtext").style.backgroundColor = "white";
        document.getElementById("accrestarttext").style.backgroundColor = "white";
        
        document.getElementById("boxentrytext").style.backgroundColor = "white";
        document.getElementById("presstext").style.backgroundColor = "white";
        document.getElementById("xgtext").style.backgroundColor = "white";
    }

    function accturnoverclick()
    {
        clickedentryindex = 999;
        selectedTag = "accturnover";
        drawActionlist(selectedTag);
        drawPitch(selectedTag, clickedentryindex, hoverentryindex, fromMinute, toMinute);
        document.getElementById("matchactionstext").innerHTML = "Accelerations actions"
        document.getElementById("accturnovertext").style.backgroundColor = "rgb(4, 224, 82)";
        document.getElementById("accshottext").style.backgroundColor = "white";
        document.getElementById("accslowtext").style.backgroundColor = "white";
        document.getElementById("accrestarttext").style.backgroundColor = "white";
        document.getElementById("boxentrytext").style.backgroundColor = "white";
        document.getElementById("presstext").style.backgroundColor = "white";
        document.getElementById("xgtext").style.backgroundColor = "white";
    }

    function accslowclick()
    {
        clickedentryindex = 999;
        selectedTag = "accslow";
        drawActionlist(selectedTag);
        drawPitch(selectedTag, clickedentryindex, hoverentryindex, fromMinute, toMinute);
        document.getElementById("matchactionstext").innerHTML = "Accelerations actions"
        document.getElementById("accslowtext").style.backgroundColor = "rgb(4, 224, 82)";
        document.getElementById("accshottext").style.backgroundColor = "white";
        document.getElementById("accturnovertext").style.backgroundColor = "white";
        document.getElementById("accrestarttext").style.backgroundColor = "white";
        document.getElementById("boxentrytext").style.backgroundColor = "white";
        document.getElementById("presstext").style.backgroundColor = "white";
        document.getElementById("xgtext").style.backgroundColor = "white";
    }

    function accrestartclick()
    {
        clickedentryindex = 999;
        selectedTag = "accrestart";
        drawActionlist(selectedTag);
        drawPitch(selectedTag, clickedentryindex, hoverentryindex, fromMinute, toMinute);
        document.getElementById("matchactionstext").innerHTML = "Accelerations actions"
        document.getElementById("accrestarttext").style.backgroundColor = "rgb(4, 224, 82)";
        document.getElementById("accshottext").style.backgroundColor = "white";
        document.getElementById("accturnovertext").style.backgroundColor = "white";
        document.getElementById("accslowtext").style.backgroundColor = "white";
        document.getElementById("boxentrytext").style.backgroundColor = "white";
        document.getElementById("presstext").style.backgroundColor = "white";
        document.getElementById("xgtext").style.backgroundColor = "white";
    }

    function drawPitch(tagtype, clickedentryindex, hoveredaction, fromTime, toTime)
    {
        ctx.clearRect(0,0, canvas.width, canvas.height)
        if (selectedTag != "press")
        {
            ctx.drawImage(img, 0, 0, 600, 850)    
        }
        else
        {
            ctx.drawImage(pressimg, 0, 0, 600, 850)
        }

        objectList = [];
        objectListIndex = [];

        for (let i = 0; i<taglog.length; i++)
        {
            var actioncolor
            var actioncolor1
            var actioncolor2

            if (taglog[i].ownaction == true)
            {
                var actioncolor = "rgba(0, 106, 158, 1)"
                var actioncolor1 = "rgba(2, 161, 240, 0.2)";
                var actioncolor2 = "rgba(0, 106, 158, 1)";
            }
            else
            {
                var actioncolor = "rgba(194, 0, 55, 1)"
                var actioncolor1 = "rgba(227, 2, 66, 0.2)";
                var actioncolor2 = "rgba(194, 0, 55, 1)";
            }

            if (hoveredaction == taglog[i])
            {
                if (taglog[i].ownaction == true)
                {
                    actioncolor = "rgba(1, 41, 133, 1)";
                    actioncolor1 = "rgba(0, 88, 186, 0.2)"
                    actioncolor2 = "rgba(1, 64, 135, 1)";
                }
                else
                {
                    actioncolor = "rgba(161, 0, 24, 1)";
                    actioncolor1 = "rgba(219, 2, 35, 0.2)"
                    actioncolor2 = "rgba(161, 0, 24, 1)";
                }   
            }

            if (taglog[i].tag == tagtype && taglog[i].timeminute >= fromTime && taglog[i].timeminute <= toTime)
            {
                if (taglog.indexOf(taglog[i]) == clickedentryindex)
                {                  
                    taglog[i].tags.forEach((element) => {

                        if (taglog[i].ownaction == true)
                        {
                            actioncolor = "rgba(1, 41, 133, 1)";
                            actioncolor1 = "rgba(2, 10, 173, 0.2)"
                            actioncolor2 = "rgba(1, 7, 117, 1)";
                        }
                        else
                        {
                            actioncolor = "rgba(156, 2, 2, 1)";
                            actioncolor1 = "rgba(214, 0, 0, 0.2)"
                            actioncolor2 = "rgba(156, 2, 2, 1)";
                        } 

                        if (element.tag == "pass")
                        {
                            drawPass(element.startingx * pitchpos.width, element.startingy * pitchpos.height, element.endingx * pitchpos.width, element.endingy * pitchpos.height, actioncolor1, actioncolor2, i)
                        }
                        else if (element.tag == "dribble")
                        {
                            drawDribble(element.startingx * pitchpos.width, element.startingy * pitchpos.height, element.endingx * pitchpos.width, element.endingy * pitchpos.height, actioncolor2, i)
                        }
                        else if (element.tag == "transitionplus")
                        {
                            drawTransitionPlus(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor2, i)
                        }
                        else if (element.tag == "transitionminus")
                        {
                            drawTransitionMinus(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor2, i)
                        }
                        else if (element.tag == "foul")
                        {
                            drawFoul(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor2, i)
                        }
                        else if (element.tag == "clearance")
                        {
                            drawClearance(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor2, i)
                        }
                        else if (element.tag == "xg")
                        {
                            if (element.goalornot == true)
                            {
                                drawXG(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor2, true, element.xgvalue, i)
                            }
                            else
                            {
                                drawXG(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor2, false, element.xgvalue, i)
                            }
                        }
                    })
                }
                else
                {
                    taglog[i].tags.forEach((element) => {
                        if (element.tag == "pass")
                        {
                            drawPass(element.startingx * pitchpos.width, element.startingy * pitchpos.height, element.endingx * pitchpos.width, element.endingy * pitchpos.height, actioncolor1, actioncolor2, i)
                        }
                        else if (element.tag == "dribble")
                        {
                            drawDribble(element.startingx * pitchpos.width, element.startingy * pitchpos.height, element.endingx * pitchpos.width, element.endingy * pitchpos.height, actioncolor2, i)
                        }
                        else if (element.tag == "transitionplus")
                        {
                            drawTransitionPlus(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor, i)
                        }
                        else if (element.tag == "transitionminus")
                        {
                            drawTransitionMinus(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor, i)
                        }
                        else if (element.tag == "foul")
                        {
                            drawFoul(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor, i)
                        }
                        else if (element.tag == "clearance")
                        {
                            drawClearance(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor, i)
                        }
                        else if (element.tag == "xg")
                        {
                            if (element.goalornot == true)
                            {
                                drawXG(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor2, true, element.xgvalue, i)
                            }
                            else
                            {
                                drawXG(element.startingx * pitchpos.width, element.startingy * pitchpos.height, actioncolor2, false, element.xgvalue, i)
                            }
                        }
                    })
                }
            }
        }
    }

    function drawPass(startx, starty, endx, endy, color1, color2, actionIndex)
    {
        var object = new Path2D();
        object.index = actionIndex;
        objectList.push(object);
        ctx.beginPath();
        ctx.lineWidth = 6;
        ctx.lineCap = "round"
        ctx.setLineDash([])
        color = ctx.createLinearGradient(startx, starty, endx, endy);
        color.addColorStop(0, color1);
        color.addColorStop(0.7, color2);
        ctx.strokeStyle = color;
        object.moveTo(startx, starty);
        object.lineTo(endx, endy);
        ctx.stroke(object);
    }

    function drawDribble(startx, starty, endx, endy, color, actionIndex)
    {
        var object = new Path2D();
        object.index = actionIndex;
        objectList.push(object);
        ctx.beginPath();
        ctx.lineWidth = 5;
        ctx.lineCap = "round"
        ctx.setLineDash([10,10])
        ctx.strokeStyle = color;
        object.moveTo(startx, starty);
        object.lineTo(endx, endy);
        ctx.stroke(object);
    }

    function drawTransitionPlus(startx, starty, color, actionIndex)
    {
        var object = new Path2D();
        object.index = actionIndex;
        objectList.push(object);
        ctx.beginPath();
        ctx.lineWidth = 13;
        ctx.setLineDash([])
        ctx.fillStyle = color;
        ctx.strokeStyle = color;
        object.arc(startx, starty, 6, 0, 2 * Math.PI);
        ctx.fill(object);
        ctx.stroke(object);
    }

    function drawTransitionMinus(startx, starty, color, actionIndex)
    {
        var object = new Path2D();
        object.index = actionIndex;
        objectList.push(object);
        ctx.beginPath();
        ctx.lineWidth = 6;
        ctx.setLineDash([])
        ctx.fillstyle = color
        ctx.strokeStyle = color;
        object.moveTo(startx - 10, starty - 10);
        object.lineTo(startx + 10, starty + 10);
        object.moveTo(startx + 10, starty - 10);
        object.lineTo(startx - 10, starty + 10);
        ctx.stroke(object);
    }

    function drawFoul(startx, starty, color, actionIndex)
    {
        var object = new Path2D();
        object.index = actionIndex;
        objectList.push(object);
        ctx.beginPath();
        ctx.lineWidth = 6;
        ctx.setLineDash([])
        ctx.fillstyle = color
        ctx.strokeStyle = color;
        object.moveTo(startx - 10, starty - 10);
        object.lineTo(startx + 10, starty + 10);
        object.moveTo(startx + 10, starty - 10);
        object.lineTo(startx - 10, starty + 10);
        ctx.stroke(object);
    }

    function drawClearance(startx, starty, color, actionIndex)
    {
        var object = new Path2D();
        object.index = actionIndex;
        objectList.push(object);
        ctx.beginPath();
        ctx.lineWidth = 12;
        ctx.setLineDash([])
        ctx.fillstyle = color
        ctx.strokeStyle = color;
        object.rect(startx, starty, 6, 6)
        ctx.stroke(object)
    }

    function drawXG(startx, starty, color, goalornot, xgvalue, actionIndex)
    {
        var object = new Path2D();
        object.index = actionIndex;
        objectList.push(object);
        ctx.beginPath();
        ctx.lineCap = "butt"
        var xgSize = 10 + Math.floor(parseFloat(xgvalue) * 30);
        ctx.lineWidth = xgSize;
        ctx.setLineDash([10,1])
        if (goalornot == true)
        {
            ctx.setLineDash([4,1])
            
        }
        else
        {
            ctx.setLineDash([0,0])
        }
        ctx.fillStyle = color
        ctx.strokeStyle = color;
        object.arc(startx, starty, xgSize/2, 0, 2 * Math.PI);
        ctx.fill(object);
        ctx.stroke(object);
    }

    function drawActionlist(tagtype)
    {
        document.getElementById("taglist").innerHTML = "";
        for (let i = 0; i<taglog.length; i++)
        {
            var ownaction = "Gnistan"

            if (taglog[i].ownaction == false)
            {
                ownaction = matchAndVideoSettings.awayTeam;
            }

            var element = taglog[i]
            if (element.tag == tagtype && element.timeminute >= fromMinute && element.timeminute <= toMinute)
            {
                var modifiedSecond = element.timesecond
                if (element.timesecond < 10)
                {
                    modifiedSecond = "0" + element.timesecond
                }

                var entry = document.createElement("li");
                if (element.tag == "press")
                {
                    var entrytext = document.createTextNode(i + ", " + ownaction + ", " + element.tags[0].tag + ", " + element.timeminute + ":" + modifiedSecond)
                }
                else if (element.tag == "xg")
                {
                    if (element.tags[0].goalornot == true)
                    {
                        var entrytext = document.createTextNode(i + ", " + ownaction + ", Goal, " + element.tags[0].xgvalue + "xG, " + element.timeminute + ":" + modifiedSecond)
                    }
                    else
                    {
                        var entrytext = document.createTextNode(i + ", " + ownaction + ", " + element.tags[0].xgvalue + "xG, " + element.timeminute + ":" + modifiedSecond)
                    }
                }
                else
                {
                    var entrytext = document.createTextNode(i + ", " + ownaction + ", " + element.timeminute + ":" + modifiedSecond)
                }
                entry.appendChild(entrytext);
                entrylist.appendChild(entry);
            }  
        }
    }

    function calculateReport(fromTime, toTime)
    {
        var homegoals = 0;
        var awaygoals = 0;
        var homeboxentry = 0;
        var awayboxentry = 0;
        var homeboxentrybydribble = 0;
        var homeboxentrybypass = 0;
        var awayboxentrybydribble = 0;
        var awayboxentrybypass = 0;
        var homeaccshot = 0;
        var awayaccshot = 0;
        var homeaccturnover = 0;
        var awayaccturnover = 0;
        var homeaccslow = 0;
        var awayaccslow = 0;
        var homeaccrestart = 0;
        var awayaccrestart = 0;
        var homexg = 0;
        var awayxg = 0;
        var homepress = 0;
        var awaypress = 0;
        var hometransitionplus = 0;
        var awaytransitionplus = 0;
        var homefoul = 0;
        var awayfoul = 0;
        var homeclearance = 0;
        var awayclearance = 0;
        var homepresspresszone = 0;
        var hometransitionpluspresszone = 0;
        var homefoulpresszone = 0;
        var homeclearancepresszone = 0;
        var homepressblockzone = 0;
        var hometransitionplusblockzone = 0;
        var homefoulblockzone = 0;
        var homeclearanceblockzone = 0;
        var homepresschasezone = 0;
        var hometransitionpluschasezone = 0;
        var homefoulchasezone = 0;
        var homeclearancechasezone = 0;
        var awaytransitionpluspresszone = 0;
        var awaypresspresszone = 0;
        var awayfoulpresszone = 0;
        var awayclearancepresszone = 0;
        var awaypressblockzone = 0;
        var awaytransitionplusblockzone = 0;
        var awayfoulblockzone = 0;
        var awayclearanceblockzone = 0;
        var awaypresschasezone = 0;
        var awaytransitionpluschasezone = 0;
        var awayfoulchasezone = 0;
        var awayclearancechasezone = 0;

        for (i = 0; i < taglog.length; i++)
        {
            if (taglog[i].tag == "boxentry" && taglog[i].timeminute >= fromTime && taglog[i].timeminute <= toTime)
            {
                if (taglog[i].ownaction == true)
                {
                    homeboxentry++;

                    if (taglog[i].tags[taglog[i].tags.length-1].tag == "pass")
                    {
                        homeboxentrybypass++;
                    }
                    else
                    {
                        homeboxentrybydribble++;
                    }
                }
                else
                {
                    awayboxentry++;

                    if (taglog[i].tags[taglog[i].tags.length-1].tag == "pass")
                    {
                        awayboxentrybypass++;
                    }
                    else
                    {
                        awayboxentrybydribble++;
                    }
                }
            }
            else if(taglog[i].tag == "xg" && taglog[i].timeminute >= fromTime && taglog[i].timeminute <= toTime)
            {
                if (taglog[i].ownaction == true)
                {
                    homexg = homexg + taglog[i].tags[0].xgvalue;
                    homexg = Math.round(homexg * 100) / 100
                    if (taglog[i].tags[0].goalornot == true)
                    {
                        homegoals++;
                    }
                }
                else
                {
                    awayxg = awayxg + taglog[i].tags[0].xgvalue;
                    awayxg = Math.round(awayxg * 100) / 100
                    if (taglog[i].tags[0].goalornot == true)
                    {
                        awaygoals++;
                    }
                }
            }
            else if (taglog[i].tag == "press" && taglog[i].timeminute >= fromTime && taglog[i].timeminute <= toTime)
            {
                if (taglog[i].ownaction == true)
                {
                    homepress++;

                    if (taglog[i].tags[0].tag == "transitionplus")
                    {
                        hometransitionplus++;

                        if (taglog[i].tags[0].startingy < 0.333)
                        {
                            hometransitionpluspresszone++;
                        }
                        else if (taglog[i].tags[0].startingy < 0.667)
                        {
                            hometransitionplusblockzone++;
                        }
                        else
                        {
                            hometransitionpluschasezone++;
                        }
                    }
                    else if (taglog[i].tags[0].tag == "foul")
                    {
                        homefoul++;

                        if (taglog[i].tags[0].startingy < 0.333)
                        {
                            homefoulpresszone++;
                        }
                        else if (taglog[i].tags[0].startingy < 0.667)
                        {
                            homefoulblockzone++;
                        }
                        else
                        {
                            homefoulchasezone++;
                        }
                    }
                    else
                    {
                        homeclearance++;

                        if (taglog[i].tags[0].startingy < 0.333)
                        {
                            homeclearancepresszone++;
                        }
                        else if (taglog[i].tags[0].startingy < 0.667)
                        {
                            homeclearanceblockzone++;
                        }
                        else
                        {
                            homeclearancechasezone++;
                        }
                    }
                }
                else
                {
                    awaypress++;

                    if (taglog[i].tags[0].tag == "transitionplus")
                    {
                        awaytransitionplus++;

                        if (taglog[i].tags[0].startingy < 0.333)
                        {
                            awaytransitionpluspresszone++;
                        }
                        else if (taglog[i].tags[0].startingy < 0.667)
                        {
                            awaytransitionplusblockzone++;
                        }
                        else
                        {
                            awaytransitionpluschasezone++;
                        }
                    }
                    else if (taglog[i].tags[0].tag == "foul")
                    {
                        awayfoul++;

                        if (taglog[i].tags[0].startingy < 0.333)
                        {
                            awayfoulpresszone++;
                        }
                        else if (taglog[i].tags[0].startingy < 0.667)
                        {
                            awayfoulblockzone++;
                        }
                        else
                        {
                            awayfoulchasezone++;
                        }
                    }
                    else
                    {
                        awayclearance++;

                        if (taglog[i].tags[0].startingy < 0.333)
                        {
                            awayclearancepresszone++;
                        }
                        else if (taglog[i].tags[0].startingy < 0.667)
                        {
                            awayclearanceblockzone++;
                        }
                        else
                        {
                            awayclearancechasezone++;
                        }
                    }
                }
            }
            else if (taglog[i].tag == "accshot" && taglog[i].timeminute >= fromTime && taglog[i].timeminute <= toTime)
            {
                if (taglog[i].ownaction == true)
                {
                    homeaccshot++;
                }
                else
                {
                    awayaccshot++;
                }
            }
            else if (taglog[i].tag == "accturnover" && taglog[i].timeminute >= fromTime && taglog[i].timeminute <= toTime)
            {
                if (taglog[i].ownaction == true)
                {
                    homeaccturnover++;
                }
                else
                {
                    awayaccturnover++;
                }
            }
            else if (taglog[i].tag == "accslow" && taglog[i].timeminute >= fromTime && taglog[i].timeminute <= toTime)
            {
                if (taglog[i].ownaction == true)
                {
                    homeaccslow++;
                }
                else
                {
                    awayaccslow++;
                }
            }
            else if (taglog[i].tag == "accrestart" && taglog[i].timeminute >= fromTime && taglog[i].timeminute <= toTime)
            {
                if (taglog[i].ownaction == true)
                {
                    homeaccrestart++;
                }
                else
                {
                    awayaccrestart++;
                }
            }
        }

        homepresspresszone = hometransitionpluspresszone + homefoulpresszone + homeclearancepresszone;
        homepressblockzone = hometransitionplusblockzone + homefoulblockzone + homeclearanceblockzone;
        homepresschasezone = hometransitionpluschasezone + homefoulchasezone + homeclearancechasezone;
        awaypresspresszone = awaytransitionpluspresszone + awayfoulpresszone + awayclearancepresszone;
        awaypressblockzone = awaytransitionplusblockzone + awayfoulblockzone + awayclearanceblockzone;
        awaypresschasezone = awaytransitionpluschasezone + awayfoulchasezone + awayclearancechasezone;

        console.log("home acc shot:" + homeaccshot)

        document.getElementById("homegoaltext").innerHTML = homegoals;
        document.getElementById("awaygoaltext").innerHTML = awaygoals;
        document.getElementById("homeboxentrytext").innerHTML = homeboxentry;
        document.getElementById("awayboxentrytext").innerHTML = awayboxentry;
        document.getElementById("homeboxentrytext2").innerHTML = homeboxentry;
        document.getElementById("awayboxentrytext2").innerHTML = awayboxentry;
        document.getElementById("homeboxentrybypasstext").innerHTML = homeboxentrybypass;
        document.getElementById("homeboxentrybydribbletext").innerHTML = homeboxentrybydribble;
        document.getElementById("awayboxentrybypasstext").innerHTML = awayboxentrybypass;
        document.getElementById("awayboxentrybydribbletext").innerHTML = awayboxentrybydribble;
        document.getElementById("homeaccshottext").innerHTML = homeaccshot;
        document.getElementById("awayaccshottext").innerHTML = awayaccshot;
        document.getElementById("homeaccturnovertext").innerHTML = homeaccturnover;
        document.getElementById("awayaccturnovertext").innerHTML = awayaccturnover;
        document.getElementById("homeaccslowtext").innerHTML = homeaccslow;
        document.getElementById("awayaccslowtext").innerHTML = awayaccslow;
        document.getElementById("homeaccrestarttext").innerHTML = homeaccrestart;
        document.getElementById("awayaccrestarttext").innerHTML = awayaccrestart;
        document.getElementById("homexgtext").innerHTML = homexg;
        document.getElementById("awayxgtext").innerHTML = awayxg;
        document.getElementById("homepresstext").innerHTML = homepress;
        document.getElementById("awaypresstext").innerHTML = awaypress;
        document.getElementById("homepresspresszonetext").innerHTML = homepresspresszone;
        document.getElementById("awaypresspresszonetext").innerHTML = awaypresspresszone;
        document.getElementById("homepressblockzonetext").innerHTML = homepressblockzone;
        document.getElementById("awaypressblockzonetext").innerHTML = awaypressblockzone;
        document.getElementById("homepresschasezonetext").innerHTML = homepresschasezone;
        document.getElementById("awaypresschasezonetext").innerHTML = awaypresschasezone;
        document.getElementById("homepresstext2").innerHTML = homepress;
        document.getElementById("awaypresstext2").innerHTML = awaypress;
        document.getElementById("hometransitionplustext").innerHTML = hometransitionplus;
        document.getElementById("awaytransitionplustext").innerHTML = awaytransitionplus;
        document.getElementById("hometransitionpluspresszonetext").innerHTML = hometransitionpluspresszone;
        document.getElementById("awaytransitionpluspresszonetext").innerHTML = awaytransitionpluspresszone;
        document.getElementById("hometransitionplusblockzonetext").innerHTML = hometransitionplusblockzone;
        document.getElementById("awaytransitionplusblockzonetext").innerHTML = awaytransitionplusblockzone;
        document.getElementById("hometransitionpluschasezonetext").innerHTML = hometransitionpluschasezone;
        document.getElementById("awaytransitionpluschasezonetext").innerHTML = awaytransitionpluschasezone;
        document.getElementById("homefoultext").innerHTML = homefoul;
        document.getElementById("awayfoultext").innerHTML = awayfoul;
        document.getElementById("homefoulpresszonetext").innerHTML = homefoulpresszone;
        document.getElementById("awayfoulpresszonetext").innerHTML = awayfoulpresszone;
        document.getElementById("homefoulblockzonetext").innerHTML = homefoulblockzone;
        document.getElementById("awayfoulblockzonetext").innerHTML = awayfoulblockzone;
        document.getElementById("homefoulchasezonetext").innerHTML = homefoulchasezone;
        document.getElementById("awayfoulchasezonetext").innerHTML = awayfoulchasezone;
        document.getElementById("homeclearancetext").innerHTML = homeclearance;
        document.getElementById("awayclearancetext").innerHTML = awayclearance;
        document.getElementById("homeclearancepresszonetext").innerHTML = homeclearancepresszone;
        document.getElementById("awayclearancepresszonetext").innerHTML = awayclearancepresszone;
        document.getElementById("homeclearanceblockzonetext").innerHTML = homeclearanceblockzone;
        document.getElementById("awayclearanceblockzonetext").innerHTML = awayclearanceblockzone;
        document.getElementById("homeclearancechasezonetext").innerHTML = homeclearancechasezone;
        document.getElementById("awayclearancechasezonetext").innerHTML = awayclearancechasezone;
    }

    function calculatePos(fromTime, toTime)
    {
        homepossec = 0;
        awaypossec = 0;
        ooppossec = 0;

        if (poslog.length > 1)
        {
            poslog.forEach(element => {
            if (element.possession == "home" && fromTime <= Math.floor(element.second / 60) && toTime > Math.floor(element.second / 60))
            {
                homepossec++;
            }
            else if (element.possession == "away" && fromTime <= Math.floor(element.second / 60) && toTime > Math.floor(element.second / 60))
            {
                awaypossec++;
            }
            else if (element.possession == "outofplay" && fromTime <= Math.floor(element.second / 60) && toTime > Math.floor(element.second / 60))
            {
                ooppossec++;
            }
            });

            homeposperc = homepossec / (homepossec + awaypossec)
            awayposperc = awaypossec / (homepossec + awaypossec)

            document.getElementById("homepostext").innerHTML = Math.round(homeposperc * 100) + " %"
            document.getElementById("awaypostext").innerHTML = Math.round(awayposperc * 100) + " %"
        }
        else
        {
            document.getElementById("homepostext").innerHTML = "0 %"
            document.getElementById("awaypostext").innerHTML = "0 %"
        }

        
    }

    function matchChange()
    {
        if (document.getElementById("matches").value == 1)
        {
            selectedMatchID = 1;
            Promise.all([
                fetch("https://d1w1llg3a01ri8.cloudfront.net/p10_TPS_taglog_110125.txt").then(res => res.json()),
                fetch("https://d1w1llg3a01ri8.cloudfront.net/TPS_matchvideosettings_110125.txt").then(res => res.json())
            ]).then(data => startReport(data[0], [], data[1]))
        
            // fetch("https://d1w1llg3a01ri8.cloudfront.net/Kapa_taglog.txt").then(res => res.json()).then(data => startReport(data))
        }
        else if (document.getElementById("matches").value == 2)
        {
            selectedMatchID = 2;
            Promise.all([
                fetch("https://d1w1llg3a01ri8.cloudfront.net/Kapa_taglog.txt").then(res => res.json()),
                fetch("https://d1w1llg3a01ri8.cloudfront.net/Kapa_matchvideosettings_190125.txt").then(res => res.json())
            ]).then(data => startReport(data[0], [], data[1]))
        }
        else
        {
            console.log("IOPIOP")
        }

        document.getElementById("xgtext").style.backgroundColor = "white";
        document.getElementById("boxentrytext").style.backgroundColor = "white";
        document.getElementById("presstext").style.backgroundColor = "white";
        document.getElementById("accrestarttext").style.backgroundColor = "white";
        document.getElementById("accshottext").style.backgroundColor = "white";
        document.getElementById("accturnovertext").style.backgroundColor = "white";
        document.getElementById("accslowtext").style.backgroundColor = "white";
    }

</script>
</html>